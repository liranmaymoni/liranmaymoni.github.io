---
title: "Emotional State and Traders' Expectations in Asset Markets - Experimental Evidence"
author: "Afik, Lahav, Maymoni & Noussair"
output:
  html_document:
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---
```{r, echo= FALSE, message=FALSE,warning = FALSE}
library(tidyverse)
library(varhandle)
```

# CM Session 1 (06/03/2019) 

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190603/Session20190603.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,2465]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2503]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2511]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))

for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i+15))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```



# CM Session 2 (06/11/2019) 

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190611/Session20190611.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,2465]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2503]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2511]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))

for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i+15))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```







# CM Session 3 (06/12/2019)  

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190612/Session20190612.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,2465]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2503]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2511]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))

for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i+15))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```





# CM Session 4 (06/18/2019)

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190618/Session20190618.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,2465]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2503]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2511]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))

for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i+15))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```





# CM Session 5 (06/19/2019)A

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190619A/Session20190619A.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,2465]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2503]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2511]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))

for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i+15))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```




# CM Session 6 (06/19/2019)B

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190619B/Session20190619B.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V21==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,2465]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2503]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,2511]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))

for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i+15))[1:participates,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V5 %in% (1:investors), V27 != 0))[1:investors,7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V5 %in% (investors+1:participates), V27 != 0))[1:(participates -investors),7:21]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```







# CDA Pilot Session (Israel) (01/21/2020) 

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
library(tidyverse)
library(varhandle)
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/CDA_Sessions/israel_pilot/Log0121/191224_1051.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,51]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,88]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,95]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),70]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),70]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15+i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```




# CDA Session 1 (with errors) (02/25/2020) 

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
library(tidyverse)
library(varhandle)
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/CDA_Sessions/session_1_with_errors/Log0225/200225_1317.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,53]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,87]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,93]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),70]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),70]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15+i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```


# CDA Session 2 (02/27/2020) 

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
library(tidyverse)
library(varhandle)
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/CDA_Sessions/session_2/Log0227/200227_1236.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,53]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,87]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,93]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(2:16),70]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(17:31),70]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15+i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```


## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```


# CDA Session 3 (03/05/2020) 

## Partipicate: Investors and Observers
```{r, echo= FALSE, message=FALSE}
library(tidyverse)
library(varhandle)
mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/CDA_Sessions/session_3/Log0305/200305_1209.csv", header=FALSE, sep=",")
participates = nrow(subset(subset(mydata, V3 == "subjects"),V4==1))
investors = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==0))
observers = nrow(subset((subset(subset(mydata, V3 == "subjects"),V4==1)),V16==1))
subjects = matrix(c(participates,investors,observers),ncol=1,byrow=TRUE)
rownames(subjects) <- c("Participates","Investors","Observers")
colnames(subjects) = c("#")
subjects
```

## HL, CRT and Gender distributions {.tabset}
### HL distributions
```{r, echo= FALSE, message=FALSE}
HL = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==1))[,53]))
ggplot(data.frame(HL), aes(x=HL)) + 
  geom_histogram(fill="lightblue", color="grey50", binwidth=0.5)+
  ggtitle("HL Distribution (Extreme risk seeking = 10)")
```

### CRT distributions
```{r, echo= FALSE, message=FALSE}
CRT = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,87]))
ggplot(data.frame(CRT), aes(x=CRT)) + 
  geom_histogram(fill="lightgreen", color="grey50", binwidth=0.5)+ggtitle("CRT Distribution")
```

### Gender distributions
```{r, echo= FALSE, message=FALSE}
gender = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V4==30))[,93]))
ggplot(data.frame(gender),aes(x=gender)) + scale_x_continuous(name = " ", breaks = c(0, 1))+
  geom_histogram(fill="yellow", color="grey50", binwidth=0.5)+ggtitle("Gender (Female=1)")
```

## Market Prices

```{r, echo= FALSE, message=FALSE}
market_prices_1 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(1:15),70]))
market_prices_2 = unfactor(as.factor(data.frame(mydata %>% filter(V3=="subjects", V5==1))[c(16:30),70]))
fundemental_value = c(180,168,156,144,132,120,108,96,84,72,60,48,36,24,12)
a = c(1:15)
plot( market_prices_1~a, type="o" ,bty="l", xlab="Period" , ylab="Price" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(0,max(max(market_prices_1),max(market_prices_2),max(fundemental_value)) ))
lines(market_prices_2 ~a , col=rgb(0.2,0.2,1,0.7) , lwd=2 , pch=17 , type="o" )
lines(fundemental_value ~a , col=rgb(0.63,0.63,0.63,0.7) , lwd=2 , type="l" )
legend("bottomleft", legend = c("Market 1", "Market 2", "Fundemental Value"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.63,0.63,0.63,0.7)), pch = c(19,17,15),
       bty = "n", pt.cex = 1.2, cex = 0.9, text.col = "black", horiz = F , inset = c(0.1, 0.1))


```


## Average Subjects' Beliefs {.tabset}
### All participates - market 1

```{r, echo= FALSE, message=FALSE}
market1_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs[i,] = colMeans(x)
}

market1_beliefs[market1_beliefs == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs,na.rm = TRUE)))
lines(as.numeric(market1_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### All participates - market 2

```{r, echo= FALSE, message=FALSE}
market2_beliefs = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15+i))[1:participates,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs[i,] = colMeans(x)
}
market2_beliefs[market2_beliefs == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs,na.rm = TRUE)))
lines(as.numeric(market2_beliefs[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Investors only - market 1
```{r, echo= FALSE, message=FALSE}

market1_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_investors[i,] = colMeans(x)
}
market1_beliefs_investors[market1_beliefs_investors == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Investors only - market 2
```{r, echo= FALSE, message=FALSE}

market2_beliefs_investors = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4== 15 + i, V27 %in% (1:investors)))[1:investors,12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_investors[i,] = colMeans(x)
}

market2_beliefs_investors[market2_beliefs_investors == 0] = NA

a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_investors[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_investors,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_investors[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_investors[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Observers only - market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market1_beliefs_observers[i,] = colMeans(x)
}

market1_beliefs_observers[market1_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market1_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market1_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)

```

### Observers only - market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_observers = as.data.frame(matrix(0, ncol = 15, nrow = 15))
for(i in 1:15){
  x = data.frame(mydata %>% filter(V3=="contracts",V4==15 + i, V27 %in% (investors+1:participates)))[1:(participates -investors),12:26]
  x = sapply( x, as.numeric)
  market2_beliefs_observers[i,] = colMeans(x)
}
market2_beliefs_observers[market2_beliefs_observers == 0] = NA
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_observers[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Price" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(0,max(market2_beliefs_observers,na.rm = TRUE)))
lines(as.numeric(market2_beliefs_observers[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_observers[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)



```

## Belief differences between Investors and Observers {.tabset}
### Market 1
```{r, echo= FALSE, message=FALSE}
market1_beliefs_dif = (market1_beliefs_observers - market1_beliefs_investors)/market1_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market1_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market1_beliefs_dif,na.rm = TRUE),max(market1_beliefs_dif,na.rm = TRUE)),
      main="(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs")
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market1_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market1_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```

### Market 2
```{r, echo= FALSE, message=FALSE}
market2_beliefs_dif = (market2_beliefs_observers - market2_beliefs_investors)/market2_beliefs_investors
a = c(1:15)
par(mar=c(5,4,2,9))
plot( as.numeric(market2_beliefs_dif[1,])~a, type="l" ,bty="l", xlab="Period forecast" , ylab="Percentage Difference" ,
      col=rgb(230/255, 25/255, 75/255) , lwd=2, pch=19,ylim=c(min(market2_beliefs_dif,na.rm = TRUE),max(market2_beliefs_dif,na.rm = TRUE)),
      main=("(Obs_Beliefs - Inv_Beliefs)/Inv_Beliefs"))
abline(a = 0, b = 0, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE)
lines(as.numeric(market2_beliefs_dif[2,])~a , col=rgb(60/255, 180/255, 75/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[3,])~a , col=rgb(255/255, 225/255, 25/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[4,])~a , col=rgb(0/255, 130/255, 200/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[5,])~a , col=rgb(245/255, 130/255, 48/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[6,])~a , col=rgb(70/255, 240/255, 240/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[7,])~a , col=rgb(240/255, 50/255, 230/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[8,])~a , col=rgb(250/255, 190/255, 190/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[9,])~a , col=rgb(0/255, 128/255, 128/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[10,])~a , col=rgb(230/255, 190/255, 255/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[11,])~a , col=rgb(170/255, 110/255, 40/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[12,])~a , col=rgb(0/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[13,])~a , col=rgb(128/255, 0/255, 0/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[14,])~a , col=rgb(170/255, 255/255, 195/255) , lwd=1 , pch=17 , type="l" )
lines(as.numeric(market2_beliefs_dif[15,])~a , col=rgb(0/255, 0/255, 128/255) , lwd=1 , pch=15 , type="o" )
legend("topleft", c("Period 1", "Period 2", "Period 3","Period 4","Period 5","Period 6","Period 7","Period 8"
                    ,"Period 9","Period 10","Period 11","Period 12","Period 13","Period 14","Period 15"), pch=15,
       col = c(rgb(230/255, 25/255, 75/255),rgb(60/255, 180/255, 75/255),
               rgb(255/255, 225/255, 25/255),rgb(0/255, 130/255, 200/255),
               rgb(245/255, 130/255, 48/255),rgb(70/255, 240/255, 240/255),
               rgb(240/255, 50/255, 230/255),rgb(250/255, 190/255, 190/255),
               rgb(0/255, 128/255, 128/255),rgb(230/255, 190/255, 255/255),
               rgb(170/255, 110/255, 40/255),rgb(0/255, 0/255, 0/255),
               rgb(128/255, 0/255, 0/255),rgb(170/255, 255/255, 195/255),rgb(0/255, 0/255, 128/255)),
       inset=c(1,0), xpd=TRUE, bty="n",cex = 0.7)
```
