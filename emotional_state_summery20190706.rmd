---
title: "Emotions summary"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
    theme: cosmo
    highlight: textmate
---

# All sessions

## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(tidyverse)
library(varhandle)
library(ggplot2)
library(nnet)
S1 <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190603/Session20190603.csv", header=FALSE, sep=",")
S2 <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190611/Session20190611.csv", header=FALSE, sep=",")
S3 <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190612/Session20190612.csv", header=FALSE, sep=",")
S4 <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190618/Session20190618.csv", header=FALSE, sep=",")
S5 <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190619A/Session20190619A.csv", header=FALSE, sep=",")
S6 <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Session20190619B/Session20190619B.csv", header=FALSE, sep=",")

mydata <- read.csv(file="C:/Users/Liran/Google Drive/Study/PhD/Face_Reader/The_Experiment/Emotional_state_summery/emotional_progression_beliefs.csv", header=TRUE, sep=",")

emotions_progression = mydata

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```


## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2"), 
       col = c(rgb(0.62,0.62,0.62) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62) ), pch = c(19,17,NA),lty=c(NA,NA,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```

# Session 1


## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression = subset(mydata, s_num=="S1")
market_prices_1 = unfactor(as.factor(data.frame(S1 %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(S1 %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
max1 = which.is.max(market_prices_1)
max2 = which.is.max(market_prices_2)

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```



## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2", "Peak price period"), 
       col = c(rgb(0.62,0.62,0.62), rgb(0,0.8,0) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2", "Peak price period"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62), rgb(0,0.8,0) ), pch = c(19,17,NA,NA),lty=c(NA,NA,2,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```

# Session 2


## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression = subset(mydata, s_num=="S2")
market_prices_1 = unfactor(as.factor(data.frame(S2 %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(S2 %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
max1 = which.is.max(market_prices_1)
max2 = which.is.max(market_prices_2)

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```



## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2", "Peak price period"), 
       col = c(rgb(0.62,0.62,0.62), rgb(0,0.8,0) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2", "Peak price period"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62), rgb(0,0.8,0) ), pch = c(19,17,NA,NA),lty=c(NA,NA,2,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```

# Session 3


## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression = subset(mydata, s_num=="S3")
market_prices_1 = unfactor(as.factor(data.frame(S3 %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(S3 %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
max1 = which.is.max(market_prices_1)
max2 = which.is.max(market_prices_2)

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```



## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2", "Peak price period"), 
       col = c(rgb(0.62,0.62,0.62), rgb(0,0.8,0) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2", "Peak price period"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62), rgb(0,0.8,0) ), pch = c(19,17,NA,NA),lty=c(NA,NA,2,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```


# Session 4


## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression = subset(mydata, s_num=="S4")
market_prices_1 = unfactor(as.factor(data.frame(S4 %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(S4 %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
max1 = which.is.max(market_prices_1)
max2 = which.is.max(market_prices_2)

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```



## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2", "Peak price period"), 
       col = c(rgb(0.62,0.62,0.62), rgb(0,0.8,0) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2", "Peak price period"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62), rgb(0,0.8,0) ), pch = c(19,17,NA,NA),lty=c(NA,NA,2,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```


# Session 5


## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression = subset(mydata, s_num=="S5")
market_prices_1 = unfactor(as.factor(data.frame(S5 %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(S5 %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
max1 = which.is.max(market_prices_1)
max2 = which.is.max(market_prices_2)

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```



## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2", "Peak price period"), 
       col = c(rgb(0.62,0.62,0.62), rgb(0,0.8,0) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2", "Peak price period"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62), rgb(0,0.8,0) ), pch = c(19,17,NA,NA),lty=c(NA,NA,2,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```


# Session 6


## Emotions Mean and S.D {.tabset}
Mean and standard deviation of emotions across subjects and 10-s interbals (in the belief stage)

### Mean - Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression = subset(mydata, s_num=="S6")
market_prices_1 = unfactor(as.factor(data.frame(S6 %>% filter(V3=="subjects", V5==1))[c(1:15),57]))
market_prices_2 = unfactor(as.factor(data.frame(S6 %>% filter(V3=="subjects", V5==1))[c(16:30),57]))
max1 = which.is.max(market_prices_1)
max2 = which.is.max(market_prices_2)

average_all =c()
average_all$Neutral = mean(emotions_progression$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")



```

### S.D Markets 1+2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_1, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_1, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 1

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_1[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

### Mean - Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_2 = subset(emotions_progression, period >15)

average_all =c()
average_all$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all = as.data.frame(average_all)

emotions_progression_traders = subset(emotions_progression_market_2, traders_1==1)
average_traders = c()
average_traders$Neutral = mean(emotions_progression_traders$neutral , na.rm = TRUE)
average_traders$Happy = mean(emotions_progression_traders$happy , na.rm = TRUE)
average_traders$Sad = mean(emotions_progression_traders$sad , na.rm = TRUE)
average_traders$Angry = mean(emotions_progression_traders$angry , na.rm = TRUE)
average_traders$Surprised = mean(emotions_progression_traders$surprised , na.rm = TRUE)
average_traders$Scared = mean(emotions_progression_traders$scared , na.rm = TRUE)
average_traders$Disgusted = mean(emotions_progression_traders$disgusted , na.rm = TRUE)
average_traders$Valence = mean(emotions_progression_traders$valence , na.rm = TRUE)
average_traders = as.data.frame(average_traders)

emotions_progression_observers = subset(emotions_progression_market_2, traders_1==0)
average_observers = c()
average_observers$Neutral = mean(emotions_progression_observers$neutral , na.rm = TRUE)
average_observers$Happy = mean(emotions_progression_observers$happy , na.rm = TRUE)
average_observers$Sad = mean(emotions_progression_observers$sad , na.rm = TRUE)
average_observers$Angry = mean(emotions_progression_observers$angry , na.rm = TRUE)
average_observers$Surprised = mean(emotions_progression_observers$surprised , na.rm = TRUE)
average_observers$Scared = mean(emotions_progression_observers$scared , na.rm = TRUE)
average_observers$Disgusted = mean(emotions_progression_observers$disgusted , na.rm = TRUE)
average_observers$Valence = mean(emotions_progression_observers$valence , na.rm = TRUE)
average_observers = as.data.frame(average_observers)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,average_all)
traders_observers = rbind(traders_observers,average_traders)
traders_observers = rbind(traders_observers,average_observers)

#t.test
Neutral= t.test(emotions_progression_traders$neutral, emotions_progression_observers$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_traders$happy, emotions_progression_observers$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_traders$sad, emotions_progression_observers$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_traders$angry, emotions_progression_observers$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_traders$surprised, emotions_progression_observers$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_traders$scared, emotions_progression_observers$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_traders$disgusted, emotions_progression_observers$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_traders$valence, emotions_progression_observers$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

traders_observers = rbind(traders_observers,p_value)



row.names(traders_observers) = c("All Participates","Traders", "Observers", "P-Value")
kable(traders_observers, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between traders and observers")

```

### S.D Markets 2

```{r, echo= FALSE, message=FALSE, warning=FALSE}

SD_all = apply(emotions_progression_market_2[,3:10],2,sd , na.rm = TRUE)
SD_traders = apply(emotions_progression_traders[,3:10],2,sd , na.rm = TRUE)
SD_observers = apply(emotions_progression_observers[,3:10],2,sd , na.rm = TRUE)

traders_observers =data.frame()
traders_observers = rbind(traders_observers,SD_all)
traders_observers = rbind(traders_observers,SD_traders)
traders_observers = rbind(traders_observers,SD_observers)
row.names(traders_observers) = c("All Participates","Traders", "Observers")
colnames(traders_observers) = c("Neutral", "Happy", "Sad" , "Angry" , "Surprised" , "Scared" , "Disgusted" ,"Valence")
kable(traders_observers, caption = "S.D")

```

## Difference Between Markets  {.tabset}

### All Participants

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_2 = subset(emotions_progression, period >15)

#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Traders Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 1)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 1)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```

### Observers Only

```{r, echo= FALSE, message=FALSE, warning=FALSE}

emotions_progression_market_1 = subset(emotions_progression, period <16)
emotions_progression_market_1 = subset(emotions_progression_market_1, traders_1 == 0)
emotions_progression_market_2 = subset(emotions_progression, period >15)
emotions_progression_market_2 = subset(emotions_progression_market_2, traders_1 == 0)


#market 1
average_all_1 =c()
average_all_1$Neutral = mean(emotions_progression_market_1$neutral , na.rm = TRUE)
average_all_1$Happy = mean(emotions_progression_market_1$happy , na.rm = TRUE)
average_all_1$Sad = mean(emotions_progression_market_1$sad , na.rm = TRUE)
average_all_1$Angry = mean(emotions_progression_market_1$angry , na.rm = TRUE)
average_all_1$Surprised = mean(emotions_progression_market_1$surprised , na.rm = TRUE)
average_all_1$Scared = mean(emotions_progression_market_1$scared , na.rm = TRUE)
average_all_1$Disgusted = mean(emotions_progression_market_1$disgusted , na.rm = TRUE)
average_all_1$Valence = mean(emotions_progression_market_1$valence , na.rm = TRUE)
average_all_1 = as.data.frame(average_all_1)

#market 2
average_all_2 =c()
average_all_2$Neutral = mean(emotions_progression_market_2$neutral , na.rm = TRUE)
average_all_2$Happy = mean(emotions_progression_market_2$happy , na.rm = TRUE)
average_all_2$Sad = mean(emotions_progression_market_2$sad , na.rm = TRUE)
average_all_2$Angry = mean(emotions_progression_market_2$angry , na.rm = TRUE)
average_all_2$Surprised = mean(emotions_progression_market_2$surprised , na.rm = TRUE)
average_all_2$Scared = mean(emotions_progression_market_2$scared , na.rm = TRUE)
average_all_2$Disgusted = mean(emotions_progression_market_2$disgusted , na.rm = TRUE)
average_all_2$Valence = mean(emotions_progression_market_2$valence , na.rm = TRUE)
average_all_2 = as.data.frame(average_all_2)

#t.test
Neutral= t.test(emotions_progression_market_1$neutral, emotions_progression_market_2$neutral, alternative = "two.sided", var.equal = FALSE)
Happy= t.test(emotions_progression_market_1$happy, emotions_progression_market_2$happy, alternative = "two.sided", var.equal = FALSE)
Sad= t.test(emotions_progression_market_1$sad, emotions_progression_market_2$sad, alternative = "two.sided", var.equal = FALSE)
Angry= t.test(emotions_progression_market_1$angry, emotions_progression_market_2$angry, alternative = "two.sided", var.equal = FALSE)
Surprised= t.test(emotions_progression_market_1$surprised, emotions_progression_market_2$surprised, alternative = "two.sided", var.equal = FALSE)
Scared= t.test(emotions_progression_market_1$scared, emotions_progression_market_2$scared, alternative = "two.sided", var.equal = FALSE)
Disgusted= t.test(emotions_progression_market_1$disgusted, emotions_progression_market_2$disgusted, alternative = "two.sided", var.equal = FALSE)
Valence= t.test(emotions_progression_market_1$valence, emotions_progression_market_2$valence, alternative = "two.sided", var.equal = FALSE)

p_value =c()
p_value$Neutral = Neutral$p.value
p_value$Happy = Happy$p.value
p_value$Sad = Sad$p.value
p_value$Angry = Angry$p.value
p_value$Surprised = Surprised$p.value
p_value$Scared = Scared$p.value
p_value$Disgusted = Disgusted$p.value
p_value$Valence = Valence$p.value
p_value = as.data.frame(p_value)

market_1_2 =data.frame()
market_1_2 = rbind(market_1_2,average_all_1)
market_1_2 = rbind(market_1_2,average_all_2)
market_1_2 = rbind(market_1_2,p_value)

row.names(market_1_2) = c("Market 1","Market 2", "P-Value")
kable(market_1_2, caption = "Mean, P-Value represent the unpaired two-samples t-test (two-tailed tests) between Market 1 and Market 2")

```



## Emotions Progression {.tabset}

### All participants

```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}

neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs = cbind(emotions_progression_beliefs,period)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,neutral)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,happy)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,sad)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,angry)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,surprised)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,scared)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,disgusted)
emotions_progression_beliefs = cbind(emotions_progression_beliefs,valence)
colnames(emotions_progression_beliefs)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs = as.data.frame(emotions_progression_beliefs)

#all participants
emotions = emotions_progression_beliefs
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$neutral), max(emotions$neutral)), main= "Neutral")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$happy~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$happy), max(emotions$happy)), main= "Happy")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$sad~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$sad), max(emotions$sad)), main= "Sad")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$angry~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$angry), max(emotions$angry)), main= "Angry")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$surprised~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$surprised), max(emotions$surprised)), main= "Surprised")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$scared~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$scared), max(emotions$scared)), main= "Scared")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$disgusted~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$disgusted), max(emotions$disgusted)), main= "Disgusted")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions$valence~a, type="o" ,bty="l", xlab="" , ylab="" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=2, pch=19,ylim=c(min(emotions$valence), max(emotions$valence)),main= "Valence")
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n", lwd=2)
legend("top", legend = c("Start of market 2", "Peak price period"), 
       col = c(rgb(0.62,0.62,0.62), rgb(0,0.8,0) ),lty=c(2),
       bty = "n",lwd=2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE)
```

### Investors / Observers
```{r, echo= FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
#traders
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_traders = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 1))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,period)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,neutral)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,happy)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,sad)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,angry)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,surprised)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,scared)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,disgusted)
emotions_progression_beliefs_traders = cbind(emotions_progression_beliefs_traders,valence)
colnames(emotions_progression_beliefs_traders)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_traders = as.data.frame(emotions_progression_beliefs_traders)

#observers
neutral = c()
happy = c()
sad = c()
angry = c()
surprised = c()
scared = c()
disgusted = c()
valence = c()
emotions_progression_beliefs_observers = c()
for(i in 1:30){
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$neutral , na.rm = TRUE)
  neutral=rbind(neutral,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$happy , na.rm = TRUE)
  happy=rbind(happy,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$sad , na.rm = TRUE)
  sad=rbind(sad,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$angry , na.rm = TRUE)
  angry=rbind(angry,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$surprised , na.rm = TRUE)
  surprised=rbind(surprised,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$scared , na.rm = TRUE)
  scared=rbind(scared,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$disgusted , na.rm = TRUE)
  disgusted=rbind(disgusted,x)
  x = mean((emotions_progression%>% filter(period == i, traders_1 == 0))$valence , na.rm = TRUE)
  valence=rbind(valence,x)
}
period = t(t(c(1:30)))
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,period)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,neutral)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,happy)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,sad)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,angry)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,surprised)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,scared)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,disgusted)
emotions_progression_beliefs_observers = cbind(emotions_progression_beliefs_observers,valence)
colnames(emotions_progression_beliefs_observers)= c("period", "neutral", "happy", "sad", "angry", "surprised", "scared", "disgusted","valence")
emotions_progression_beliefs_observers = as.data.frame(emotions_progression_beliefs_observers)

#emotions progression 

emotions_t = emotions_progression_beliefs_traders
emotions_o = emotions_progression_beliefs_observers
par(oma = c(1, 1, 3, 1))
par(mfrow=c(4,2), mar = rep(2, 4))
a = c(1:30)
plot( emotions_t$neutral~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$neutral,emotions_o$neutral), max(emotions_t$neutral,emotions_o$neutral)),main= "Neutral")
lines(emotions_o$neutral ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$happy~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$happy,emotions_o$happy), max(emotions_t$happy,emotions_o$happy)),main= "Happy")
lines(emotions_o$happy ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$sad~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$sad,emotions_o$sad), max(emotions_t$sad,emotions_o$sad)),main= "Sad")
lines(emotions_o$sad ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$angry~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$angry,emotions_o$angry), max(emotions_t$angry,emotions_o$angry)),main= "Angry")
lines(emotions_o$angry ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$surprised~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$surprised,emotions_o$surprised), max(emotions_t$surprised,emotions_o$surprised)),main= "Surprised")
lines(emotions_o$surprised ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$scared~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$scared,emotions_o$scared), max(emotions_t$scared,emotions_o$scared)),main= "Scared")
lines(emotions_o$scared ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$disgusted~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$disgusted,emotions_o$disgusted), max(emotions_t$disgusted,emotions_o$disgusted)),main= "Disgusted")
lines(emotions_o$disgusted ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
plot( emotions_t$valence~a, type="o" ,bty="l", xlab="Period" , ylab="Degree of Emotion" ,
      col=rgb(1,0.2,0.2,0.7) , lwd=1, pch=19,
      ylim=c(min(emotions_t$valence,emotions_o$valence), max(emotions_t$valence,emotions_o$valence)),main= "Valence")
lines(emotions_o$valence ~a , col=rgb(0.2,0.2,1,0.7) , lwd=1 , pch=19 , type="o" )
abline(v=15.5,col = "gray60", lwd=2, lty=2)
abline(v=max1,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(v=max2+15,col = c(rgb(0,0.8,0)), lwd=2, lty=2)
abline(a = 0, b = 0)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend("top", legend = c("Investors", "Observers", "Start of market 2", "Peak price period"), 
       col = c(rgb(1,0.2,0.2,0.7), rgb(0.2,0.2,1,0.7),rgb(0.62,0.62,0.62), rgb(0,0.8,0) ), pch = c(19,17,NA,NA),lty=c(NA,NA,2,2),
       bty = "n", pt.cex = 2, cex = 1.2, text.col = "black", horiz = T , inset = c(0,0),
       xpd = TRUE, lwd=2)


```
